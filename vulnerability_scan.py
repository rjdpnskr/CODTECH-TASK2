import subprocess
import nmap

def scan_host(ip_address):
  """Scans a single host for open ports."""
  try:
    scanner = nmap.PortScanner()
    scanner.scan(ip_address)
    for host in scanner.all_hosts():
      print("Host : %s (%s)" % (scanner[host].hostname(), scanner[host].hostaddr))
      for proto in scanner[host].all_protocols():
        print("Protocol : %s" % (proto))
        lport = scanner[host][proto].keys()
        for port in lport:
          print("port : %s\tstate : %s" % (port, scanner[host][proto][port]['state']))
  except Exception as e:
    print(f"An error occurred during scanning: {e}")

def scan_network(network):
  """Scans a network range for hosts."""
  try:
    scanner = nmap.PortScanner()
    scanner.scan(hosts=network)
    hosts_list = [(x, scanner[x]['status']['state']) for x in scanner.all_hosts()]
    for host, status in hosts_list:
      print(f"Host: {host} - Status: {status}")
  except Exception as e:
    print(f"An error occurred during network scanning: {e}")

if __name__ == "__main__":
  while True:
    print("\nSelect an option:")
    print("1. Scan a single host")
    print("2. Scan a network range")
    print("3. Exit")
    choice = input("Enter your choice: ")

    if choice == '1':
      ip_address = input("Enter the IP address: ")
      scan_host(ip_address)
    elif choice == '2':
      network = input("Enter the network range (e.g., 192.168.1.0/24): ")
      scan_network(network)
    elif choice == '3':
      break
    else:
      print("Invalid choice. Please try again.")